(function(){"use strict";function u(r){self.onmessage=async t=>{if(typeof t.data!="object")return;const{data:n}=t,{id:l,method:o,args:a}=n;if(!l||!o){console.warn("invalid message",n);return}else console.log(`calling ${o} with`,a);const s=await r[o](...a);self.postMessage({id:l,result:s})}}const g=require("@babel/standalone"),c="index.tsx";function m(r,t,n=[]){return console.log("compiling file",r),g.transform(t,{presets:[["react",{pragma:"createElement",pragmaFrag:"Fragment",throwIfNamespace:!1,development:!0,useBuiltIns:!0,isTSX:!0,allExtensions:!0}],["typescript",{jsxPragma:"createElement",jsxPragmaFrag:"Fragment",isTSX:!0,allExtensions:!0}]],filename:r,plugins:n}).code}class f{compile(t){console.log("compiling",t);const n=t[c],l=Object.fromEntries([...Object.entries(t)].filter(([s])=>s!==c).map(([s,i])=>{const e=s.replace(/\.(ts|tsx|jsx)$/,".js");return[e.replace(/\.(ts|tsx|jsx)$/,".js"),m(e,i)]})),o={},a={visitor:{ImportDeclaration(s){const i=s.node.source.value;if(!i.startsWith("./"))return;const e=i.replace(/^\.\//,"");if(!o[e]&&l[e]){const p=m(e,l[e],[a]);console.log("compiling file",e,"for import",i),console.log("compiled file",e,p),o[e]=URL.createObjectURL(new Blob([p],{type:"text/javascript"}))}o[e]?s.node.source.value=o[e]:console.warn(`file ${e} not found`)}}};return m(c,n,[a])}}u(new f)})();
